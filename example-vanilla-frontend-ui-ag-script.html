<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vanilla Airgap.js Implementation</title>

    <!-- =================================================================== -->
    <!-- PART 1: THE "VANILLA" SCRIPT TAG                                    -->
    <!-- We have removed `data-ui="off"` and `onload`. The script will now   -->
    <!-- automatically load its own CSS and show its own UI.                 -->
    <!-- =================================================================== -->
    <script
      data-cfasync="false"
      src="https://consent-modules.visionworks.com/cm-test/843a2eb4-77c8-4184-9136-71d50fe29864/airgap.js"
    ></script>

    <!-- =================================================================== -->
    <!-- PART 2: THE API STUB                                                -->
    <!-- Still a good practice to prevent race conditions with our footer link. -->
    <!-- =================================================================== -->
    <script>
      try {
        if (!self?.transcend?.ready) {
          self.transcend = {
            readyQueue: [],
            ready(callback) { this.readyQueue.push(callback); },
            ...self.transcend,
          };
        }
      } catch (e) { console.log('Transcend stub exception: ', e); }
    </script>

    <style>
        /* Basic styles for the page ONLY. No styles for the consent UI. */
        body { font-family: sans-serif; line-height: 1.6; margin: 0; padding-bottom: 150px; }
        header, footer { background-color: #0b2335; color: #ffffff; padding: 1rem 2rem; text-align: center; }
        main { padding: 2rem; min-height: 80vh; }
        footer a { color: #b0c4de; text-decoration: underline; cursor: pointer; }
        footer a:hover { color: #ffffff; }
    </style>
</head>
<body>
    <header><h1>Mock Site Header</h1></header>
    <main>
        <h2>Vanilla Implementation</h2>
        <p>This page uses the most basic, out-of-the-box setup.</p>
        <p>The consent banner/modal you see is 100% generated and controlled by the `airgap.js` script itself, based on the settings in the Transcend dashboard.</p>
    </main>
    <footer><p>Â© 2023 | <a id="cookie-choices-link">Your Cookie Choices</a></p></footer>
    
    <!-- NOTE: All of our custom HTML for the banner and modal has been removed. -->

    <!-- =================================================================== -->
    <!-- PART 3: MINIMAL JAVASCRIPT "GLUE"                                   -->
    <!-- We only need to wire up our footer link to the API. The script      -->
    <!-- will handle the rest.                                               -->
    <!-- =================================================================== -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const footerLink = document.getElementById('cookie-choices-link');

            if (footerLink) {
                footerLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    // Use the ready queue to safely call the API
                    self.transcend.ready((transcend) => {
                        // This is the official function to programmatically open the default UI
                        transcend.showConsentManager();
                    });
                });
            }
        });
    </script>
</body>
</html>
